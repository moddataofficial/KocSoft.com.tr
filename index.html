<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Pro Tank Savaşı</title>
    <style>
        body { margin: 0; background: #1a1a1a; color: white; font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }
        #game-wrapper { position: relative; border: 4px solid #333; border-radius: 8px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        canvas { background: #4a5d23; display: block; cursor: crosshair; }
        .ui { position: absolute; top: 10px; left: 10px; right: 10px; display: flex; justify-content: space-between; pointer-events: none; font-size: 20px; text-shadow: 2px 2px black; }
        #overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.7); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10; }
        button { padding: 15px 40px; font-size: 24px; cursor: pointer; background: #2ecc71; border: none; color: white; border-radius: 5px; transition: 0.2s; }
        button:hover { background: #27ae60; transform: scale(1.05); }
    </style>
</head>
<body>

<div id="game-wrapper">
    <div class="ui">
        <div id="hp">CAN: 100</div>
        <div id="score">SKOR: 0</div>
    </div>
    <div id="overlay">
        <h1 id="title">TANK SAVAŞI</h1>
        <button onclick="startGame()">OYUNU BAŞLAT</button>
    </div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const hpEl = document.getElementById('hp');
const scoreEl = document.getElementById('score');
const overlay = document.getElementById('overlay');

let gameActive = false;
let score = 0;
let health = 100;
let enemies = [];
let bullets = [];
let keys = {};

// Oyuncu Objesi
const player = {
    x: 400, y: 300, size: 40, speed: 4, angle: 0
};

// Kontroller
window.addEventListener('keydown', e => keys[e.code] = true);
window.addEventListener('keyup', e => keys[e.code] = false);

function startGame() {
    gameActive = true;
    score = 0;
    health = 100;
    enemies = [];
    bullets = [];
    overlay.style.display = 'none';
    spawnEnemy(); // İlk düşman
    gameLoop();
}

function spawnEnemy() {
    if (!gameActive) return;
    const x = Math.random() < 0.5 ? -50 : canvas.width + 50;
    const y = Math.random() * canvas.height;
    enemies.push({ x, y, size: 40, health: 2, speed: 1.5 + (score/1000) });
    setTimeout(spawnEnemy, Math.max(500, 2000 - (score/5))); // Skor arttıkça hızlanır
}

function update() {
    if (health <= 0) {
        gameActive = false;
        overlay.style.display = 'flex';
        document.getElementById('title').innerText = "KAYBETTİN! SKOR: " + score;
        return;
    }

    // Oyuncu Hareketi
    if (keys['KeyW'] || keys['ArrowUp']) player.y -= player.speed;
    if (keys['KeyS'] || keys['ArrowDown']) player.y += player.speed;
    if (keys['KeyA'] || keys['ArrowLeft']) player.x -= player.speed;
    if (keys['KeyD'] || keys['ArrowRight']) player.x += player.speed;

    // Ateş Etme (Boşluk Tuşu)
    if (keys['Space'] && !player.cooldown) {
        bullets.push({ 
            x: player.x, y: player.y, 
            vx: Math.cos(player.angle) * 8, 
            vy: Math.sin(player.angle) * 8 
        });
        player.cooldown = true;
        setTimeout(() => player.cooldown = false, 300);
    }

    // Mermi Güncelleme
    bullets.forEach((b, i) => {
        b.x += b.vx; b.y += b.vy;
        if (b.x < 0 || b.x > 800 || b.y < 0 || b.y > 600) bullets.splice(i, 1);
    });

    // Düşman Güncelleme
    enemies.forEach((en, i) => {
        const dx = player.x - en.x;
        const dy = player.y - en.y;
        const dist = Math.sqrt(dx*dx + dy*dy);
        en.x += (dx/dist) * en.speed;
        en.y += (dy/dist) * en.speed;

        // Oyuncuya çarpma
        if (dist < 30) {
            health -= 0.5; // Temas halinde can gider
            hpEl.innerText = `CAN: ${Math.ceil(health)}`;
        }

        // Mermi ile vurulma
        bullets.forEach((b, bi) => {
            const bDist = Math.sqrt((en.x-b.x)**2 + (en.y-b.y)**2);
            if (bDist < 25) {
                enemies.splice(i, 1);
                bullets.splice(bi, 1);
                score += 100;
                scoreEl.innerText = `SKOR: ${score}`;
            }
        });
    });
}

function draw() {
    ctx.clearRect(0, 0, 800, 600);

    // Oyuncu Çizimi (Yeşil Tank)
    ctx.save();
    ctx.translate(player.x, player.y);
    // Mouse'a bakma mantığı
    window.onmousemove = e => {
        const rect = canvas.getBoundingClientRect();
        player.angle = Math.atan2(e.clientY - rect.top - player.y, e.clientX - rect.left - player.x);
    };
    ctx.rotate(player.angle);
    ctx.fillStyle = '#2ecc71';
    ctx.fillRect(-20, -20, 40, 40); // Gövde
    ctx.fillStyle = '#27ae60';
    ctx.fillRect(0, -5, 30, 10); // Namlu
    ctx.restore();

    // Düşman Çizimi (Kırmızı Tank)
    enemies.forEach(en => {
        ctx.fillStyle = '#e74c3c';
        ctx.fillRect(en.x - 15, en.y - 15, 30, 30);
    });

    // Mermi Çizimi
    bullets.forEach(b => {
        ctx.fillStyle = 'yellow';
        ctx.beginPath();
        ctx.arc(b.x, b.y, 5, 0, Math.PI*2);
        ctx.fill();
    });
}

function gameLoop() {
    if (!gameActive) return;
    update();
    draw();
    requestAnimationFrame(gameLoop);
}
</script>
</body>
</html>
